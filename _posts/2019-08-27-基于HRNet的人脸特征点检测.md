---
layout: post
title: 基于HRNet的人脸特征点检测
categories:
  - 人工智能
description: 基于HRNet的人脸特征点检测
keywords: 'HRNet, 人脸识别, 人脸特征点检测'
comments: true
---

# 基于HRNet的人脸特征点检测
## 摘要
&emsp;&emsp;在本篇文章中我们主要研究**人脸特征点检测**，使用的网络结构为中科大与微软亚洲研究院，发布的HRNet。HRNet着重于输出可靠的高分辨率表征（reliable highresolution representation）。目前现有的大多数方法都是从高分辨率到低分辨率网络（high-to-low resolution network）产生的低分辨率表征中恢复高分辨率表征。相反，HRNet能在整个过程中都保持**高分辨率的表征**。
&emsp;&emsp;HRNet从高分辨率子网络（high-resolution subnetwork）作为第一阶段开始，逐步增加高分辨率到低分辨率的子网，形成更多的阶段，**并将多分辨率的子网并行连接**。之后通过多次多尺度融合，使得每一个高分辨率到低分辨率的表征都从其他并行表示中反复接收信息，从而得到丰富的高分辨率表征。因此预测的人脸特征可能更准确，在空间上也更精确。论文地址：[High-Resolution Representations for Labeling Pixels and Regions](https://arxiv.org/pdf/1904.04514.pdf)

## 简介
&emsp;&emsp;纵观深度学习的发展表明，深度卷积神经网络已经取得非常优越的性能。大多数现有的方法，通过一个网络（通常由高分辨率到低分辨率的子网串联而成）传递输入，然后提高分辨率。例如，**Hourglass**通过**对称的低到高分辨率**(symmetric low-to-high process)过程恢复高分辨率。**SimpleBaseline**采用少量的转置卷积层(transposed convolution layers)来生成高分辨率的表示。此外，dilated convolutions还被用于放大高分辨率到低分辨率网络(high-to-low resolution network)的后几层(如**VGGNet**或**ResNet**)。
&emsp;&emsp;**HRNet**(High-Resolution Representaions)高分辨率网络，它能够在整个过程中维护高分辨率的表示。从高分辨率子网作为第一阶段开始，**逐步增加高分辨率到低分辨率的子网**(gradually add high-to-low resolution subnetworks)，形成更多的阶段，**并将多分辨率子网并行连接**。在整个过程中，通过在并行的多分辨率子网络上反复交换信息来进行多尺度的重复融合。通过网络输出的高分辨率表示来估计关键点。生成的网络如图所示。
![HRNet00](/images/posts/AI/hrnet00.jpg)
与现有的网络相比，HRNet有以下两个好处：
* HRNet是并行连接高分辨率到低分辨率的子网，而不是像大多数现有解决方案那样串行连接。因此，HRNet能够保持高分辨率，而不是通过一个低到高的过程恢复分辨率，因此预测的结果可能在空间上更精确。
* 大多数现有的融合方案都将低层和高层的表示集合起来。相反，HRNet使用重复的多尺度融合，利用相同深度和相似级别的低分辨率表示来提高高分辨率表示。因此，其预测的结果可能更准确。

## 网络解析
&emsp;&emsp;目前，深度卷积神经网络提供了主流的解决方案。主要有两种方法：**回归关键点位置**regressing the position of keypoints和**估算关键点热图**estimating keypoint heatmaps，然后选择**热值最高**的位置作为关键点。
#### High-to-low and low-to-high
&emsp;&emsp;high-to-low 的目标是生成低分辨率和高分辨率的表征，low-to-high 的目标是生成高分辨率的表征。这两个过程可能会重复多次，以提高性能。增加多尺度信息之间的融合是非常有效的，例如原图像和模糊图像进行联合双边滤波可以得到介于两者之间的模糊程度的图像，而RGF滤波就是重复将联合双边滤波的结果作为那张模糊的引导图，这样得到的结果会越来越趋近于原图。同理，不同分辨率的图像采样到相同的尺度反复的融合，加之网络的学习能力，会使得多次融合后的结果更加趋近于正确的表示。

**现有的网络设计模式有：**
* 对称结构，先下采样，再上采样，同时使用跳层连接恢复下采样丢失的信息；
* 级联多字金字塔；
* 先下采样，转置卷积上采样，不使用跳层连接进行数据融合；
* 扩张卷积，减少下采样次数，不使用跳层连接进行数据融合；

如下图所示：
![HRNet01](/images/posts/AI/hrnet01.png)
#### 多分辨率子网络
**并行高分辨率子网**
&emsp;&emsp;以高分辨率子网为第一阶段，逐步增加高分辨率到低分辨率的子网，形成新的阶段，并将多分辨率子网并行连接。因此，后一阶段并行子网的分辨率由前一阶段的分辨率和下一阶段的分辨率组成。一个包含4个并行子网的网络结构示例如下：
![HRNet02](/images/posts/AI/hrnet02.png)

